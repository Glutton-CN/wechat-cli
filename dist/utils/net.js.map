{"version":3,"sources":["utils/net.js"],"names":["Promise","require","wxPromisify","fn","obj","resolve","reject","success","res","fail","prototype","finally","callback","P","constructor","then","value","reason","getRequest","url","data","wx","request","method","header","postRequest","postBody","module","exports"],"mappings":";;AAAA,IAAIA,UAAUC,QAAQ,WAAR,CAAd;;AAEA,SAASC,WAAT,CAAqBC,EAArB,EAAyB;AACvB,SAAO,YAAoB;AAAA,QAAVC,GAAU,uEAAJ,EAAI;;AACzB,WAAO,IAAIJ,OAAJ,CAAY,UAACK,OAAD,EAAUC,MAAV,EAAqB;AACtCF,UAAIG,OAAJ,GAAc,UAAUC,GAAV,EAAe;AAC3B;AACAH,gBAAQG,GAAR;AACD,OAHD;AAIAJ,UAAIK,IAAJ,GAAW,UAAUD,GAAV,EAAe;AACxB;AACAF,eAAOE,GAAP;AACD,OAHD;AAIAL,SAAGC,GAAH;AACD,KAVM,CAAP;AAWD,GAZD;AAaD;;AAED;AACAJ,QAAQU,SAAR,CAAkBC,OAAlB,GAA4B,UAAUC,QAAV,EAAoB;AAC9C,MAAIC,IAAI,KAAKC,WAAb;AACA,SAAO,KAAKC,IAAL,CACH;AAAA,WAASF,EAAER,OAAF,CAAUO,UAAV,EAAsBG,IAAtB,CAA2B;AAAA,aAAMC,KAAN;AAAA,KAA3B,CAAT;AAAA,GADG,EAEH;AAAA,WAAUH,EAAER,OAAF,CAAUO,UAAV,EAAsBG,IAAtB,CAA2B,YAAM;AAAE,YAAME,MAAN;AAAc,KAAjD,CAAV;AAAA,GAFG,CAAP;AAID,CAND;;AAQA;;;;;AAKA,SAASC,UAAT,CAAoBC,GAApB,EAAyBC,IAAzB,EAA+B;AAC7B,MAAIF,aAAahB,YAAYmB,GAAGC,OAAf,CAAjB;AACA,SAAOJ,WAAW;AAChBC,SAAKA,GADW;AAEhBI,YAAQ,KAFQ;AAGhBH,UAAMA,IAHU;AAIhBI,YAAQ;AACN,sBAAgB;AADV;AAJQ,GAAX,CAAP;AAQD;;AAED;;;;;AAKA,SAASC,WAAT,CAAqBN,GAArB,EAA0BC,IAA1B,EAAgC;AAC9B,MAAIK,cAAcvB,YAAYmB,GAAGC,OAAf,CAAlB;AACA,MAAII,WAAW;AACb,aAAS,EADI;AAEb,kBAAc;AACZ,oBAAc;AADF,KAFD;AAKb,YAAQN;AALK,GAAf;AAOA,SAAOK,YAAY;AACjBN,SAAKA,GADY;AAEjBI,YAAQ,MAFS;AAGjBH,UAAMM,QAHW;AAIjBF,YAAQ;AACN,sBAAgB;AADV;AAJS,GAAZ,CAAP;AAQD;;AAEDG,OAAOC,OAAP,GAAiB;AACfH,eAAaA,WADE;AAEfP,cAAYA;AAFG,CAAjB","file":"net.js","sourcesContent":["var Promise = require('./promise') ;\n\nfunction wxPromisify(fn) {\n  return function (obj = {}) {\n    return new Promise((resolve, reject) => {\n      obj.success = function (res) {\n        //成功\n        resolve(res)\n      }\n      obj.fail = function (res) {\n        //失败\n        reject(res)\n      }\n      fn(obj)\n    })\n  }\n}\n\n//无论promise对象最后状态如何都会执行\nPromise.prototype.finally = function (callback) {\n  let P = this.constructor;\n  return this.then(\n      value => P.resolve(callback()).then(() => value),\n      reason => P.resolve(callback()).then(() => { throw reason })\n  );\n};\n\n/**\n * 微信请求get方法\n * url\n * data 以对象的格式传入\n */\nfunction getRequest(url, data) {\n  var getRequest = wxPromisify(wx.request)\n  return getRequest({\n    url: url,\n    method: 'GET',\n    data: data,\n    header: {\n      'Content-Type': 'json'\n    }\n  })\n}\n\n/**\n * 微信请求post方法封装\n * url\n * data 以对象的格式传入\n */\nfunction postRequest(url, data) {\n  var postRequest = wxPromisify(wx.request);\n  var postBody = {\n    \"style\": \"\",\n    \"clientInfo\": {\n      \"clientType\": \"web\"\n    },\n    \"data\": data\n  };\n  return postRequest({\n    url: url,\n    method: 'POST',\n    data: postBody,\n    header: {\n      \"content-type\": \"application/x-www-form-urlencoded\"\n    }\n  })\n}\n\nmodule.exports = {\n  postRequest: postRequest,\n  getRequest: getRequest\n}"]}